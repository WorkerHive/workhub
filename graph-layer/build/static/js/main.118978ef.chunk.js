(this["webpackJsonpreact-workerhub"]=this["webpackJsonpreact-workerhub"]||[]).push([[0],{1030:function(e,t){},1039:function(e,t){},1041:function(e,t){},1142:function(e,t){},1147:function(e,t){},121:function(e,t,n){"use strict";var a=n(36),r=n(1443),c=n.n(r);t.a=function(){return new a.ApolloClient({link:c()({uri:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GRAPH_URL||"/graphql"}),cache:new a.InMemoryCache({addTypename:!1})})}},1216:function(e,t){},1238:function(e,t){},1240:function(e,t){},133:function(e,t,n){"use strict";var a=n(3),r=(n(0),n(314)),c=n(1437),i=n(428),o=n(153),u=n(1446),s=n(1436),l=n(77);t.a=Object(l.b)((function(e){return{user:Object(r.a)(e.auth.token)}}),(function(e){return{}}))((function(e){return Object(a.jsxs)(i.a,{className:"dashapp-header",children:[Object(a.jsx)(o.a,{variant:"h6",children:e.title}),Object(a.jsx)("div",{className:"dashapp-header__tabs",children:Object(a.jsx)(u.a,{value:e.tabs.map((function(e){return e.toLowerCase()})).indexOf(e.selectedTab.toLowerCase()),onChange:function(t,n){e.onTabSelect(e.tabs[n])},children:(e.tabs||[]).map((function(e){return Object(a.jsx)(s.a,{label:e})}))})}),Object(a.jsxs)("div",{className:"actions-col",children:[Object(a.jsx)(c.a,{}),Object(a.jsxs)("div",{className:"user-info",children:[Object(a.jsx)(o.a,{variant:"subtitle1",children:e.user.name}),Object(a.jsx)("span",{children:"Online"})]})]})]})}))},1427:function(e,t,n){},1428:function(e,t,n){},1431:function(e,t,n){},1432:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"type",(function(){return Tt})),n.d(a,"modal",(function(){return Et})),n.d(a,"node",(function(){return It}));var r={};n.r(r),n.d(r,"type",(function(){return Ft})),n.d(r,"modal",(function(){return Rt})),n.d(r,"node",(function(){return Bt}));var c={};n.r(c),n.d(c,"type",(function(){return Ut})),n.d(c,"modal",(function(){return zt})),n.d(c,"node",(function(){return Gt}));var i=n(3),o=n(0),u=n.n(o),s=n(35),l=n.n(s),d=(n(686),n(18)),j=n(309),b=n(86),f=n(36),p=n(77),O=n(51),m=n(2),h=n.n(m),x=n(89),v=n(21),g=n(1446),y=n(1436),q=n(1508),k=n(1435),C=n(667),S=n(1438),T=n(1492),E=n(1498),I=n(1499),w=n(1500),D=n(1501),P=n(1502),N=n(1503),M=n(153),A=n(1434),L=n(664),$=n(663),_=n(1485);function F(e){var t=u.a.useState(null),n=Object(v.a)(t,2),a=n[0],r=n[1];return[Object(i.jsx)(L.a,{className:"more-menu",onClick:function(e){e.preventDefault(),e.stopPropagation(),r(e.currentTarget)},children:Object(i.jsx)(A.a,{})}),Object(i.jsxs)($.a,{open:a,onClose:function(){return r(null)},anchorEl:a,children:[Object(i.jsx)(_.a,{children:"Edit"}),Object(i.jsx)(_.a,{onClick:function(){e.onDelete&&(r(null),e.onDelete())},style:{color:"red"},children:"Delete"})]})]}var R=n(133),B=n(1487),U=n(1489),z=n(1490),G=n(428),W=n(1504),H=n(1486),J=n(1488),Q=n(237);n(691);function K(e){return Object(i.jsxs)(G.a,{style:{flex:1,marginTop:12},children:[Object(i.jsxs)("div",{className:"options-bar",children:[Object(i.jsx)(W.a,{InputProps:{startAdornment:Object(i.jsx)(H.a,{position:"start",children:Object(i.jsx)(B.a,{})})},label:"Search",variant:"outlined",size:"small"}),Object(i.jsxs)(J.a,{children:[Object(i.jsx)(Q.a,{children:Object(i.jsx)(U.a,{})}),Object(i.jsx)(Q.a,{children:Object(i.jsx)(z.a,{})})]})]}),Object(i.jsx)(S.a,{}),Object(i.jsx)("div",{className:"grid-list",children:Object(i.jsx)(k.a,{children:e.data.map((function(t){return Object(i.jsx)(C.a,{children:e.renderItem(t)})}))})})]})}var V=n(1442),Y=n(668),X=n(1440),Z=n(670),ee=n(671),te=n(1441);n(692);function ne(e){var t=u.a.useState(!1),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState({}),o=Object(v.a)(c,2),s=o[0],l=o[1],d=e.permissions&&e.permissions[0]||{},j=e.type&&e.type[0]||{};u.a.useEffect((function(){e.selected&&l(e.selected)}),[e.selected]);var b=function(){e.onClose(),r(!1),l({})};return Object(i.jsxs)("div",{className:"permission-form",children:[Object(i.jsxs)(Y.a,{fullWidth:!0,open:e.selected||a,onClose:function(){b()},children:[Object(i.jsx)(X.a,{children:j.name}),Object(i.jsx)(Z.a,{style:{display:"flex",flexDirection:"column"},children:function(e){var t=[],n=function(){var n=a;"String"==e.typeDef[a]&&t.push(Object(i.jsx)(W.a,{value:s[n],onChange:function(e){var t=Object.assign({},s);t[n]=e.target.value,l(t)},label:n}))};for(var a in e.typeDef)n();return t}(j)}),Object(i.jsxs)(ee.a,{children:[Object(i.jsx)(Q.a,{onClick:function(){b()},children:"Cancel"}),Object(i.jsx)(Q.a,{onClick:function(){return e.onSave(s),void b()},color:"primary",variant:"contained",children:"Save"})]})]}),Object(i.jsx)("div",{className:"permission-form__inner",children:e.children}),d.create&&Object(i.jsx)(te.a,{onClick:function(){return r(!0)},color:"primary",style:{position:"absolute",bottom:12,right:12},children:Object(i.jsx)(V.a,{})})]})}var ae=n(60),re=n(38),ce=n(272),ie=n(121);function oe(){var e=Object(ae.a)(["\n        query GetProjects {\n          projects{\n            id\n            name\n            description\n            status\n            files{\n              cid\n            }\n          }\n        }\n      "]);return oe=function(){return e},e}function ue(){var e=Object(ae.a)(["\n          mutation RemoveProject($projectId: ID){\n            removeProject(projectId: $projectId)\n          }\n        "]);return ue=function(){return e},e}function se(){var e=Object(ae.a)(["\n  mutation UpdateProject($projectId: ID, $project: ProjectInput){\n    updateProject(projectId: $projectId, project: $project){\n      id\n      name\n      description\n      status\n    }\n  }\n"]);return se=function(){return e},e}function le(){var e=Object(ae.a)(["\n      mutation AddProject($project: ProjectInput){\n        addProject(project: $project){\n          id\n          name\n          description\n          status\n        }\n      }\n    "]);return le=function(){return e},e}var de=Object(ie.a)(),je=n(197),be=n.n(je);n(703);var fe=Object(p.b)((function(e){return{projects:e.projects.list,type:e.dashboard.types.filter((function(e){return"Projects"==e.name})),permissions:e.dashboard.permissions.filter((function(e){return"Projects"==e.type}))}}),(function(e){return{getProjects:function(){return e((function(e){return de.query({query:Object(f.gql)(oe())}).then((function(t){e({type:re.m,projects:t.data.projects.map((function(e){var t=Object(ce.cloneDeep)(e);return delete t.__typename,t}))})}))}))},addProject:function(t){return e(function(e){return function(t){return de.mutate({mutation:Object(f.gql)(le()),variables:{project:e}}).then((function(e){return e.data.addProject})).then((function(e){t({type:re.d,newProject:e})}))}}(t))},updateProject:function(t,n){return e(function(e,t){return function(n){return de.mutate({mutation:Object(f.gql)(se()),variables:{projectId:e,project:t}}).then((function(e){return e.data.updateProject})).then((function(a){n({type:re.q,project:t,id:e})}))}}(t,n))},removeProject:function(t){return e((n=t,function(e){return de.mutate({mutation:Object(f.gql)(ue()),variables:{projectId:n}}).then((function(e){return e.data.removeProject})).then((function(t){t&&e({type:re.g,id:n})}))}));var n}}}))((function(e){var t=be.a.parse(e.location.search,{ignoreQueryPrefix:!0}),n=u.a.useState(null),a=Object(v.a)(n,2),r=a[0],c=a[1];return u.a.useEffect((function(){e.getProjects()}),[]),[Object(i.jsx)(R.a,{tabs:["ALL"].concat(Object(O.a)(new Set(e.projects.filter((function(e){return null!=e.status&&void 0!=e.status})).map((function(e){return e.status.trim().toUpperCase()})))))||[],onTabSelect:function(n){"ALL"==n?(delete t.status,e.history.push("".concat(window.location.pathname,"?").concat(be.a.stringify(t)))):(t.status=n,e.history.push("".concat(window.location.pathname,"?").concat(be.a.stringify(t))))},selectedTab:t.status&&t.status.toUpperCase()||"ALL",title:"Projects"}),Object(i.jsx)(ne,{onSave:function(t){if(t.id){var n=Object.assign({},t);delete n.id,e.updateProject(t.id,n)}else e.addProject(t)},onClose:function(){return c(null)},selected:r,type:e.type,permissions:e.permissions,children:Object(i.jsx)(K,{data:e.projects.filter((function(e){return!(!t.status||e.status!=t.status)||!t.status})).filter((function(e){return e.name})),renderItem:function(t){return[Object(i.jsxs)("div",{className:"project-item",children:[Object(i.jsx)(C.a,{button:!0,onClick:function(){e.history.push("".concat(e.match.url,"/").concat(t.id,"/plan"))},children:Object(i.jsx)(M.a,{style:{flex:1},variant:"subtitle1",children:t.name})}),Object(i.jsx)(F,{onDelete:function(){e.removeProject(t.id)}})]})]}})})]}));var pe=n(198),Oe=n(1447);var me=Object(p.b)((function(e){return{files:e.files.list}}))((function(e){var t=u.a.useState(""),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState({}),o=Object(v.a)(c,2),s=o[0],l=o[1];return Object(i.jsxs)(Y.a,{fullWidth:!0,open:e.open,onClose:e.onClose,children:[Object(i.jsx)(X.a,{children:"Files"}),Object(i.jsxs)(Z.a,{children:[Object(i.jsx)(W.a,{fullWidth:!0,value:a,onChange:function(e){return r(e.target.value)},label:"Search",InputProps:{startAdornment:Object(i.jsx)(H.a,{position:"start",children:Object(i.jsx)(B.a,{})})}}),Object(i.jsx)(k.a,{children:e.files.filter((function(e){return e.filename&&e.filename.toLowerCase().indexOf(a.toLowerCase())>-1})).map((function(e){return Object(i.jsxs)(C.a,{button:!0,children:[Object(i.jsx)(Oe.a,{checked:s[e.id],onChange:function(t){var n=s;n[e.id]=t.target.checked,l(n)}}),e.filename]})}))})]}),Object(i.jsxs)(ee.a,{children:[Object(i.jsx)(Q.a,{onClick:e.onClose,children:"Close"}),Object(i.jsx)(Q.a,{color:"primary",variant:"contained",onClick:function(){e.onAttach&&(e.onAttach(s),l({}),e.onClose())},children:"Attach"})]})]})}));var he=n(15),xe=n(42),ve=n(167),ge=n(1493),ye=n(1494),qe=n(666),ke=n(1444),Ce=n(1491),Se=n(1495),Te=n(112),Ee=n(646),Ie=n.n(Ee);n(709);function we(e){var t={columns:[{id:1,title:"Backlog",cards:e.graph.nodes.filter((function(e){return"COMPLETED"!=e.status&&"BLOCKED"!=e.status})).map((function(e){return{id:e.id,title:e.data.label}}))},{id:2,title:"Doing",cards:[]},{id:3,title:"Done",cards:[]}]};return Object(i.jsx)(Ie.a,{initialBoard:t})}var De,Pe=n(457),Ne=n(423),Me=n(140),Ae=n(661),Le=function(){var e=new Me.a,t=new URL(window.location).hostname;new Ae.a("wss://".concat(t,":1234"),"workhub",e),e.getMap("");return e},$e=(n(711),Le());function _e(e){return Object(i.jsx)(qe.a,Object(d.a)(Object(d.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(i.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 11.023h-11.826q-.375 0-.669.281t-.294.682v0q0 .401.294 .682t.669.281h11.826q.375 0 .669-.281t.294-.682v0q0-.401-.294-.682t-.669-.281z"})}))}function Fe(e){return Object(i.jsx)(qe.a,Object(d.a)(Object(d.a)({fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(i.jsx)("path",{d:"M22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0zM17.873 12.977h-4.923v4.896q0 .401-.281.682t-.682.281v0q-.375 0-.669-.281t-.294-.682v-4.896h-4.923q-.401 0-.682-.294t-.281-.669v0q0-.401.281-.682t.682-.281h4.923v-4.896q0-.401.294-.682t.669-.281v0q.401 0 .682.281t.281.682v4.896h4.923q.401 0 .682.281t.281.682v0q0 .375-.281.669t-.682.294z"})}))}function Re(e){return Object(i.jsx)(qe.a,Object(d.a)(Object(d.a)({className:"close",fontSize:"inherit",style:{width:14,height:14}},e),{},{children:Object(i.jsx)("path",{d:"M17.485 17.512q-.281.281-.682.281t-.696-.268l-4.12-4.147-4.12 4.147q-.294.268-.696.268t-.682-.281-.281-.682.294-.669l4.12-4.147-4.12-4.147q-.294-.268-.294-.669t.281-.682.682-.281.696 .268l4.12 4.147 4.12-4.147q.294-.268.696-.268t.682.281 .281.669-.294.682l-4.12 4.147 4.12 4.147q.294.268 .294.669t-.281.682zM22.047 22.074v0 0-20.147 0h-20.12v0 20.147 0h20.12zM22.047 24h-20.12q-.803 0-1.365-.562t-.562-1.365v-20.147q0-.776.562-1.351t1.365-.575h20.147q.776 0 1.351.575t.575 1.351v20.147q0 .803-.575 1.365t-1.378.562v0z"})}))}function Be(e){var t=Object(Ne.useSpring)({from:{opacity:0,transform:"translate3d(20px,0,0)"},to:{opacity:e.in?1:0,transform:"translate3d(".concat(e.in?0:20,"px,0,0)")}});return Object(i.jsx)(Ne.animated.div,{style:t,children:Object(i.jsx)(ke.a,Object(d.a)({},e))})}var Ue=Object(he.a)((function(e){return{iconContainer:{"& .close":{opacity:.3}},group:{marginLeft:7,paddingLeft:18,borderLeft:"1px dashed ".concat(Object(xe.c)(e.palette.text.primary,.4))}}}))((function(e){return Object(i.jsx)(Se.a,Object(d.a)(Object(d.a)({},e),{},{label:Object(i.jsxs)("div",{className:"tree-item",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.label,Object(i.jsx)(L.a,{onClick:function(t){t.stopPropagation(),e.addChild()},children:Object(i.jsx)(V.a,{})})]}),TransitionComponent:Be}))}));Object(ve.a)({root:{height:264,flexGrow:1,maxWidth:400}});var ze=function(e){return Object(i.jsx)("div",{})},Ge=function(e){var t=u.a.useState(!1),n=Object(v.a)(t,2),a=n[0],r=n[1],c=Object(f.useMutation)(pe.a),o=Object(v.a)(c,1)[0];return Object(i.jsxs)("div",{children:[Object(i.jsx)(me,{onAttach:function(t){for(var n in t)o({variables:{projectId:e.project.id,fileId:n}})},open:a,onClose:function(){return r(!1)}}),Object(i.jsx)(te.a,{style:{position:"absolute",bottom:12,right:12},color:"primary",onClick:function(){return r(!0)},children:Object(i.jsx)(V.a,{})})]})},We=function(e){var t=u.a.useState("list"),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState([]),o=Object(v.a)(c,2),s=o[0],l=o[1],d=u.a.useState([]),j=Object(v.a)(d,2),b=j[0],f=j[1],p=u.a.useState(["root"]),O=Object(v.a)(p,2),m=O[0],h=O[1],x=u.a.useState({}),g=Object(v.a)(x,2),y=g[0],q=g[1],k=u.a.useState(null),C=Object(v.a)(k,2),E=C[0],I=C[1],w=function(){if(De){var e=De.toJSON();console.log("OBSERVE",e),null!=e.nodes&&l(e.nodes.map((function(e){return Object.assign({},e)}))),null!=e.links&&f(e.links.map((function(e){return Object.assign({},e)})))}};u.a.useEffect((function(){if(console.log("YDC",e),e.project&&$e&&e.project.id!=y.id){E&&E.unobserve(w),console.log("Setting up YDOC");var t=$e.getMap("plan-".concat(e.project.id));De=t,I(t),t.observe(w),q(e.project);var n=t.toJSON();null!=n.nodes&&l(n.nodes),null!=n.links&&f(n.links)}}),[e.project,E]);var D=function(e){E&&E.set("nodes",e),l(e)},P=function(e){E&&E.set("links",e),f(e)},N=function e(t){if(t){var n=b.filter((function(e){return e.source==t.id})).map((function(e){return s.filter((function(t){return t.id==e.target}))[0]})),a=s.filter((function(e){return e.id==t.id}))[0].position;return Object(i.jsx)(Ue,{addChild:function(){var e=M({type:"baseNode",data:{label:""},position:{x:a.x,y:a.y+121}});A({target:e.id,source:t.id})},nodeId:t.id,label:t&&t.data&&t.data.label,children:(n||[]).map((function(t){return e(t)}))})}},M=function(e){var t=s.slice();return e.id=Object(Pe.a)(),e.data||(e.data={}),e.position||(e.position={x:300,y:300}),t.push(e),D(t),e},A=function(e){var t=b.slice();return e.id=Object(Pe.a)(),t.push(e),P(t),e},L=function(){var t=s.filter((function(e){return 0==b.filter((function(t){return t.target==e.id})).length}));return Object(i.jsx)(Ce.a,{multiSelect:!0,defaultExpanded:["1"],expanded:m,onNodeToggle:function(e,t){console.log(e,t),h(t)},defaultCollapseIcon:Object(i.jsx)(_e,{}),defaultExpandIcon:Object(i.jsx)(Fe,{}),defaultEndIcon:Object(i.jsx)(Re,{}),children:Object(i.jsx)(Ue,{addChild:function(){M({type:"baseNode",data:{label:""}});console.log(s,b)},nodeId:"root",label:e.project.name,children:t.map((function(e){return N(e)}))})})};return Object(i.jsxs)("div",{style:{padding:4,display:"flex",flex:1,flexDirection:"column"},children:[Object(i.jsxs)("div",{className:"plan-header",children:[Object(i.jsx)("div",{}),Object(i.jsxs)(J.a,{children:[Object(i.jsx)(Q.a,{variant:"kanban"==a&&"contained",onClick:function(){return r("kanban")},children:Object(i.jsx)(T.a,{})}),Object(i.jsx)(Q.a,{variant:"list"==a&&"contained",onClick:function(){return r("list")},children:Object(i.jsx)(ge.a,{})}),Object(i.jsx)(Q.a,{variant:"hive"==a&&"contained",onClick:function(){return r("hive")},children:Object(i.jsx)(ye.a,{})})]})]}),Object(i.jsx)(S.a,{}),function(){switch(a){case"kanban":return Object(i.jsx)(we,{graph:{nodes:s}});case"list":return L();case"hive":return Object(i.jsx)("div",{className:"plan-hive",children:Object(i.jsx)(Te.b,{nodes:s,links:b,onNodeChange:function(e){return D(e)},onLinkChange:function(e){return P(e)}})});default:return}}()]})},He=function(e){return Object(i.jsx)("div",{})};n(715);var Je=Object(p.b)((function(e,t){return{project:e.projects.list.filter((function(e){return e.id==t.match.params.id}))}}))((function(e){var t=u.a.useState({}),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState(null),o=Object(v.a)(c,2),s=o[0],l=o[1];return u.a.useEffect((function(){e.project&&e.project.length>0&&r(e.project[0])}),[e.project]),[Object(i.jsx)(R.a,{tabs:["Plan","Calendar","Team","Files"],onTabSelect:function(t){l(t),e.history.push("".concat(e.match.url,"/").concat(t.toLowerCase()))},selectedTab:s||e.location.pathname.replace("".concat(e.match.url,"/"),""),title:a.name}),Object(i.jsx)(G.a,{style:{flex:1,marginTop:12,display:"flex"},children:Object(i.jsxs)(b.d,{children:[Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/plan"),render:function(e){return Object(i.jsx)(We,Object(d.a)(Object(d.a)({},e),{},{y:e.y,project:a}))}}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/calendar"),render:function(e){return Object(i.jsx)(ze,Object(d.a)(Object(d.a)({},e),{},{project:a}))}}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/team"),render:function(e){return Object(i.jsx)(He,Object(d.a)(Object(d.a)({},e),{},{project:a}))}}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/files"),render:function(e){return Object(i.jsx)(Ge,Object(d.a)(Object(d.a)({},e),{},{project:a}))}})]})})]})),Qe=n(647),Ke=n(1497),Ve=n(1505);function Ye(){var e=Object(ae.a)(["\n            query GetBookings{\n                calendar{\n                    id\n                    startTime\n                    endTime\n                    allDay\n                    date\n                    project {\n                        id\n                        name\n                    }\n                    items {\n                        equipment{\n                            name\n                        }\n                        team {\n                            name\n\n                        }\n                    }\n                }\n            }\n        "]);return Ye=function(){return e},e}function Xe(){var e=Object(ae.a)(["\n    mutation AddBooking($time: CalendarInput, $projectId: ID, $booking: BookingInput){\n        addBooking(time: $time, projectId: $projectId, booking: $booking){\n            id\n            startTime\n            endTime\n            allDay\n            date\n            project {\n                id \n                name\n            }\n            items {\n                equipment {\n                    name\n                }\n                team {\n                    name\n                }\n            }\n        }\n    }\n  "]);return Xe=function(){return e},e}var Ze,et=Object(ie.a)(),tt=n(1496),nt=n(1506),at=n(195),rt=n.n(at),ct=Le();var it,ot=Object(p.b)((function(e){return{projects:e.projects.list,team:e.team.list,equipment:e.equipment.list}}),(function(e){return{addBooking:function(t,n,a){return e(function(e,t,n){return function(a){et.mutate({mutation:Object(f.gql)(Xe()),variables:{time:e,projectId:t,booking:n}}).then((function(e){return e.data.addBooking})).then((function(e){a({type:re.a,booking:e})}))}}(t,n,a))}}}))((function(e){var t=u.a.useState(0),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState(0),o=Object(v.a)(c,2),s=o[0],l=o[1],j=u.a.useState(null),b=Object(v.a)(j,2),f=b[0],p=b[1],O=u.a.useState(null),m=Object(v.a)(O,2),h=m[0],x=m[1],q=u.a.useState(!1),T=Object(v.a)(q,2),E=T[0],I=T[1],w=u.a.useState(null),D=Object(v.a)(w,2),P=D[0],N=D[1],M=u.a.useState(null),A=Object(v.a)(M,2),L=A[0],$=A[1],_=u.a.useState(null),F=Object(v.a)(_,2),R=F[0],U=F[1],z=u.a.useState({}),G=Object(v.a)(z,2),J=G[0],K=G[1];return u.a.useEffect((function(){Ze=ct.getMap("calendar")}),[]),Object(i.jsxs)(Y.a,{fullWidth:!0,open:e.open,onClose:e.onClose,children:[Object(i.jsx)(X.a,{children:function(){switch(a){case 1:return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(W.a,{value:f,onChange:function(e){return p(e.target.value)},fullWidth:!0,InputProps:{startAdornment:Object(i.jsx)(H.a,{position:"start",children:Object(i.jsx)(B.a,{})})},label:"Search"}),Object(i.jsxs)(g.a,{value:s,onChange:function(e,t){t!==s&&p(""),l(t)},children:[Object(i.jsx)(y.a,{label:"Team"}),Object(i.jsx)(y.a,{label:"Equipment"})]}),Object(i.jsx)(S.a,{})]});case 0:return"Create a booking";default:return null}}()}),Object(i.jsx)(Z.a,{style:{display:"flex",flexDirection:"column",minHeight:250},children:function(){switch(a){case 0:return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ve.a,{value:R,onChange:function(e,t){return U(t)},options:e.projects,getOptionLabel:function(e){return e.name},renderInput:function(e){return Object(i.jsx)(W.a,Object(d.a)(Object(d.a)({},e),{},{label:"Project"}))}}),Object(i.jsx)(tt.a,{value:h,format:"DD/MM/yyyy",onChange:function(e,t){return x(e)},margin:"normal",label:"Date",variant:"inline"}),Object(i.jsx)(Ke.a,{control:Object(i.jsx)(Oe.a,{checked:E,onChange:function(e){I(e.target.checked)}}),label:"All day"}),!E&&Object(i.jsxs)("div",{style:{display:"flex",marginTop:8},children:[Object(i.jsx)(nt.a,{value:P,onChange:function(e){return N(e)},label:"Start Time",fullWidth:!0,style:{marginRight:4},variant:"inline"}),Object(i.jsx)(nt.a,{value:L,onChange:function(e){return $(e)},label:"End Time",fullWidth:!0,style:{marginLeft:4},variant:"inline"})]})]});case 1:return Object(i.jsx)(k.a,{children:(0==s?e.team:e.equipment).filter((function(e){return!f||e.name.toLowerCase().indexOf(f.toLowerCase())>-1})).map((function(e){return Object(i.jsxs)(C.a,{children:[Object(i.jsx)(Oe.a,{checked:J[e.id]&&J[e.id].selected||!1,onChange:function(t){var n=Object.assign({},J);n[e.id]={selected:t.target.checked,type:0==s?"team":"equipment"},console.log(n),K(n)}}),e.name]})}))});default:return null}}()}),Object(i.jsxs)(ee.a,{children:[Object(i.jsx)(Q.a,{onClick:"0"==a?e.onClose:function(){return r(0)},children:"0"==a?"Cancel":"Back"}),Object(i.jsx)(Q.a,{color:"primary",onClick:function(){if(0==a)r(1);else{var t,n,c=[],i=[];for(var o in J)if(J[o].selected)switch(J[o].type){case"team":i.push(o);break;case"equipment":c.push(o)}P&&((t=rt()(h)).set("hour",P.get("hour")),t.set("minute",P.get("minute"))),L&&((n=rt()(h)).set("hour",L.get("hour")),n.set("minute",L.get("minute")));var u=new Me.b,s={date:h.valueOf()/1e3,project:R,startTime:t&&parseInt(t.valueOf()/1e3),endTime:n&&parseInt(n.valueOf()/1e3),allDay:E,items:{team:i,equipment:c}};if(u.set("date",s.date),u.set("project",s.project),Ze){console.log("Inserting into yjs");var l=Ze.toJSON().bookings||[];console.log(l),l.push(s),Ze.set("bookings",l),console.log(Ze.toJSON())}e.onClose()}},variant:"contained",children:"1"==a?"Book":"Next"})]})]})})),ut=n(426),st=(n(728),Object(ut.b)(rt.a)),lt=Le();var dt=Object(p.b)((function(e){return{bookings:e.calendar.bookings}}),(function(e){return{getBookings:function(){return e((function(e,t){et.query({query:Object(f.gql)(Ye())}).then((function(e){return e.data.calendar})).then((function(t){console.log(t),e({type:re.h,bookings:t})}))}))}}}))((function(e){var t=u.a.useState(!1),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState([]),o=Object(v.a)(c,2),s=o[0],l=o[1],d=function(){var e=it.toJSON();e.bookings&&e.bookings.length>0&&l(e.bookings)};return u.a.useEffect((function(){(it=lt.getMap("calendar")).observe(d);var e=it.toJSON();e.bookings&&e.bookings.length>0&&l(e.bookings)}),[]),[Object(i.jsx)(R.a,{tabs:["All","Me","Projects"],selectedTab:"",onTabSelect:function(t){e.history.push("".concat(e.match.url,"/").concat(t.toLowerCase()))},title:"Calendar"}),Object(i.jsx)(ot,{y:it,open:a,onClose:function(){return r(!1)}}),Object(i.jsxs)(G.a,{style:{position:"relative",marginTop:12,height:"calc(100vh - 84px)",flex:1,display:"flex",flexDirection:"column",padding:4},children:[Object(i.jsx)(te.a,{onClick:function(){return r(!0)},color:"primary",style:{zIndex:9,position:"absolute",right:12,bottom:12},children:Object(i.jsx)(V.a,{})}),Object(i.jsx)(ut.a,{localizer:st,events:s.map((function(e){return{id:e.id,title:e.project.name,allDay:e.allDay,start:new Date(1e3*(e.startTime||e.date)),end:new Date(1e3*(e.endTime||e.date))}})),startAccessor:"start",endAccessor:"end",style:{flex:1}})]})]}));function jt(e){return Object(i.jsxs)(G.a,{style:{flex:1,marginTop:12},children:[Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:8},children:[Object(i.jsx)(M.a,{variant:"h6",style:{display:"flex"},children:"Add-ons"}),Object(i.jsx)(k.a,{children:[{name:"STP to GLB Converter"},{name:"HexNode Replication"}].map((function(e){return Object(i.jsx)(C.a,{button:!0,children:e.name})}))})]}),Object(i.jsx)(S.a,{}),Object(i.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:8},children:[Object(i.jsx)(M.a,{variant:"h6",style:{display:"flex"},children:"Connections"}),Object(i.jsx)(k.a,{children:[{name:"MSSQL Server"}].map((function(e){return Object(i.jsx)(C.a,{button:!0,children:e.name})}))})]}),Object(i.jsx)(S.a,{})]})}function bt(){var e=Object(ae.a)(["\n        query GetTeam {\n          team {\n            id\n            name\n            username\n            password\n            phoneNumber\n            email\n          }\n        }\n      "]);return bt=function(){return e},e}function ft(){var e=Object(ae.a)(["\n  mutation UpdateTeam($memberId: ID, $member: TeamMemberInput){\n    updateTeamMember(memberId: $memberId, member: $member){\n      name\n      email\n      phoneNumber\n    }\n  }\n"]);return ft=function(){return e},e}function pt(){var e=Object(ae.a)(["\n  mutation AddTeamMember($member: TeamMemberInput){\n    addTeamMember(member: $member){\n      id\n      name\n      email\n      phoneNumber\n    }\n  }\n"]);return pt=function(){return e},e}var Ot=Object(ie.a)(),mt=Object(f.gql)(ft());n(729);var ht=Object(p.b)((function(e){return{team:e.team.list,type:e.dashboard.types.filter((function(e){return"Team Members"==e.name})),permissions:e.dashboard.permissions.filter((function(e){return"Team Members"==e.type}))}}),(function(e){return{getTeam:function(){return e((function(e){return Ot.query({query:Object(f.gql)(bt())}).then((function(e){return e.data.team})).then((function(t){e({type:re.n,team:t})}))}))},addTeamMember:function(t){return e(function(e){return function(t){Ot.mutate({mutation:Object(f.gql)(pt()),variables:{member:e}}).then((function(e){return e.data.addTeamMember})).then((function(e){t({type:re.e,newMember:e})}))}}(t))}}}))((function(e){var t=u.a.useState(null),n=Object(v.a)(t,2),a=n[0],r=n[1],c=Object(f.useMutation)(mt),o=Object(v.a)(c,1)[0];return u.a.useEffect((function(){e.getTeam()}),[]),[Object(i.jsx)(R.a,{tabs:[],onTabSelect:function(e){},selectedTab:"",title:"Team"}),Object(i.jsx)(ne,{onSave:function(t){if(t.id){var n=t;delete n.id,o({variables:{memberId:t.id,member:n}})}else e.addTeamMember(t)},onClose:function(){return r(null)},selected:a,type:e.type,permissions:e.permissions,children:Object(i.jsx)(K,{data:e.team,renderItem:function(e){return Object(i.jsxs)("div",{className:"team-item",children:[Object(i.jsx)(C.a,{button:!0,onClick:function(){return r(e)},children:e.name}),Object(i.jsx)(F,{})]})}})})]}));function xt(){var e=Object(ae.a)(["\n        query GetEquipment {\n          equipment {\n            id\n            name\n            type\n            description\n          }\n        }\n      "]);return xt=function(){return e},e}function vt(){var e=Object(ae.a)(["\n        mutation RemoveEquipment($id: String){\n          removeEquipment(equipmentId: $id)\n        }\n      "]);return vt=function(){return e},e}function gt(){var e=Object(ae.a)(["\n      mutation UpdateEquipment($equipmentId: String, $equipment: EquipmentInput){\n        updateEquipment(equipmentId: $equipmentId, equipment: $equipment){\n          name\n          type\n          description\n        }\n      }\n    "]);return gt=function(){return e},e}function yt(){var e=Object(ae.a)(["\n  mutation AddEquipment($equipment: EquipmentInput){\n    addEquipment(equipment: $equipment){\n      id\n      name\n      type\n      description\n    }\n  }\n"]);return yt=function(){return e},e}var qt=Object(ie.a)();n(730);var kt=Object(p.b)((function(e){return{equipment:e.equipment.list,type:e.dashboard.types.filter((function(e){return"Equipment"==e.name})),permissions:e.dashboard.permissions.filter((function(e){return"Equipment"==e.type}))}}),(function(e){return{getEquipment:function(){return e((function(e){return qt.query({query:Object(f.gql)(xt())}).then((function(e){return e.data.equipment})).then((function(t){e({type:re.k,equipment:t})}))}))},addEquipment:function(t){return e(function(e){return function(t){qt.mutate({mutation:Object(f.gql)(yt()),variables:{equipment:e}}).then((function(e){return e.data.addEquipment})).then((function(e){t({type:re.b,newItem:e})}))}}(t))},updateEquipment:function(t,n){return e(function(e,t){return console.log(e,t),function(n){return qt.mutate({mutation:Object(f.gql)(gt()),variables:{equipmentId:e,equipment:t}}).then((function(e){return e.data.updateEquipment})).then((function(a){n({type:re.p,equipment:t,id:e})}))}}(t,n))},removeEquipment:function(t){return e(function(e){return function(t){return qt.mutate({mutation:Object(f.gql)(vt()),variables:{id:e}}).then((function(e){return e.data.removeEquipment})).then((function(n){t({type:re.f,id:e})}))}}(t))}}}))((function(e){var t=u.a.useState(null),n=Object(v.a)(t,2),a=n[0],r=n[1];return u.a.useEffect((function(){e.getEquipment()}),[]),[Object(i.jsx)(R.a,{tabs:Object(O.a)(new Set(e.equipment.filter((function(e){return e.type})).map((function(e){return e.type})))),onTabSelect:function(e){},selectedTab:"",title:"Equipment"}),Object(i.jsx)(ne,{onSave:function(t){if(t.id){var n=Object.assign({},t);console.log(t),delete n.id,e.updateEquipment(t.id,n)}else e.addEquipment(t)},onClose:function(){return r(null)},selected:a,type:e.type,permissions:e.permissions,children:Object(i.jsx)(K,{data:e.equipment,renderItem:function(t){return Object(i.jsxs)("div",{className:"equipment-item",children:[Object(i.jsx)(C.a,{button:!0,onClick:function(e){r(t)},children:t.name}),Object(i.jsx)(F,{onDelete:function(){e.removeEquipment(t.id)}})]})}})})]})),Ct=n(655),St=n.n(Ct),Tt="typeDef",Et=Object(Te.c)((function(e){return Object(i.jsx)("div",{style:{flex:1},children:Object(i.jsx)(St.a,{src:e.node.data.typedef})})})),It=Object(Te.c)((function(e){return Object(i.jsx)(Te.a,Object(d.a)(Object(d.a)({},e),{},{children:Object(i.jsx)("div",{style:{padding:8},className:"type-def",children:e.data.label})}))}));function wt(){var e=Object(ae.a)(['\n          query GetProjects {\n            bucketLayout(storeId: "','", bucketId: "','"){\n              name\n              datatype\n            }\n          }\n        ']);return wt=function(){return e},e}function Dt(){var e=Object(ae.a)(['\n        query GetLayout{\n          connectionLayout(storeId: "','"){\n            name\n          }\n        }\n      ']);return Dt=function(){return e},e}function Pt(){var e=Object(ae.a)(["\n        query GetTypes{\n          adminTypes{\n            name\n            typeDef\n          }\n        }\n      "]);return Pt=function(){return e},e}function Nt(){var e=Object(ae.a)(["\n      query GetIntegrations{\n        integrationMap{\n          nodes{\n            id\n            type\n            data\n            position{\n              x\n              y\n            }\n          }\n          links{\n            id\n            target\n            source\n          }\n        }\n      }\n    "]);return Nt=function(){return e},e}function Mt(){var e=Object(ae.a)(["\n      query GetPermissions{\n        typePermissions{\n          type\n          create\n          read\n          update\n          delete\n        }\n      }\n      "]);return Mt=function(){return e},e}function At(){var e=Object(ae.a)(["\n  mutation UpdateIntegrationMap($nodes: [MapNodeInput], $links: [MapLinkInput]){\n    updateIntegrationMap(nodes: $nodes, links: $links){\n      nodes{\n        id\n        type\n        data\n        position{\n          x\n          y\n        }\n      }\n      links{\n        id\n        target\n        source\n      }\n    }\n  }\n"]);return At=function(){return e},e}var Lt=Object(ie.a)(),$t=Object(f.gql)(At()),_t=function(){return function(e,t){return Lt.query({query:Object(f.gql)(Pt())}).then((function(e){return e.data.adminTypes})).then((function(t){console.log(t),e({type:re.j,types:t})}))}},Ft=(n(731),n(732),"mssqlAdapter"),Rt=Object(Te.c)((function(e){var t=u.a.useState([]),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState(null),o=Object(v.a)(c,2),s=(o[0],o[1],u.a.useState([])),l=Object(v.a)(s,2);l[0],l[1];u.a.useEffect((function(){var e,t=j();(e=t.id,Lt.query({query:Object(f.gql)(Dt(),e)}).then((function(e){return e.data.connectionLayout}))).then((function(e){r(e)})),console.log(j())}),[]);var j=function(){var t=e.editor.links.filter((function(t){return t.source==e.node.id}));if(t&&t.length>0){var n=t.map((function(t){return e.editor.nodes.filter((function(e){return e.id==t.target}))[0]}));if(n&&n.length>0)return n[0]}};return Object(i.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column"},children:[Object(i.jsx)(W.a,{disabled:!0,error:!j(),label:"Connection Name",value:j().data.label}),Object(i.jsx)(Ve.a,{value:e.node.data.table,onChange:function(t,n){console.log(t,n),n&&n.name&&(e.editor.updateNode(e.node.id,(function(e){return e.data.table=n,e})),function(e,t){return Lt.query({query:Object(f.gql)(wt(),e,t)}).then((function(e){return e.data.bucketLayout}))}(j().id,n.name).then((function(t){console.log("Searching for cols",n.name,t),e.editor.updateNode(e.node.id,(function(e){return e.data.availableColumns=t,e.data.provides={},e}))})))},options:a,getOptionLabel:function(e){return e.name},autoHighlight:!0,renderInput:function(e){return Object(i.jsx)(W.a,Object(d.a)(Object(d.a)({},e),{},{margin:"normal",label:"Table"}))}}),Object(i.jsx)("div",{style:{marginTop:8},children:function(){var t=e.editor.links.filter((function(t){return t.target==e.node.id}));if(t&&t.length>0){var n=t.map((function(t){return e.editor.nodes.filter((function(e){return e.id==t.source}))[0]}));if(n&&n.length>0){var a=n[0].data.typedef,r=[],c=function(){var t=o;r.push(Object(i.jsxs)("div",{style:{marginTop:4,display:"flex",alignItems:"center"},children:[Object(i.jsx)("div",{style:{width:100},children:o}),":",Object(i.jsx)("select",{value:e.node&&e.node.data&&e.node.data.provides&&e.node.data.provides[o],onChange:function(n){e.editor.updateNode(e.node.id,(function(e){return e.data.provides||(e.data.provides={}),console.log(n.target.value," provides ",t),e.data.provides[t]=n.target.value,e}))},children:(e.node.data.availableColumns||[]).concat([{name:"N/A"}]).map((function(e){return Object(i.jsx)("option",{value:e.name,children:e.name})}))})]}))};for(var o in a)c();return r}}}()})]})})),Bt=Object(Te.c)((function(e){return Object(i.jsx)(Te.a,Object(d.a)(Object(d.a)({},e),{},{children:Object(i.jsxs)("div",{style:{padding:8},className:"mssql-adapter",children:[Object(i.jsx)("div",{className:"adapter-header",children:e.data.label||"MSSQL Adapter"}),Object(i.jsx)("div",{className:"adapter-info",children:e.data&&e.data.table&&e.data.table.name})]})}))})),Ut="mssql server",zt=Object(Te.c)((function(e){return Object(i.jsxs)("div",{style:{display:"flex",flex:1,flexDirection:"column"},children:[Object(i.jsx)(W.a,{label:"Connection Name",value:e.node.data.label,onChange:function(t){e.editor.updateNode(e.node.id,(function(e){return e.data.label=t.target.value,e}))}}),Object(i.jsx)(W.a,{label:"Host IP:Host Port",value:e.node.data.host,onChange:function(t){e.editor.updateNode(e.node.id,(function(e){return e.data.host=t.target.value,e}))}}),Object(i.jsx)(W.a,{label:"Database Name",value:e.node.data.db,onChange:function(t){e.editor.updateNode(e.node.id,(function(e){return e.data.db=t.target.value,e}))}}),Object(i.jsx)(W.a,{label:"Username",value:e.node.data.username,onChange:function(t){e.editor.updateNode(e.node.id,(function(e){return e.data.username=t.target.value,e}))}}),Object(i.jsx)(W.a,{label:"Password",type:"password",value:e.node.data.password,onChange:function(t){e.editor.updateNode(e.node.id,(function(e){return e.data.password=t.target.value,e}))}})]})})),Gt=Object(Te.c)((function(e){return Object(i.jsx)(Te.a,Object(d.a)(Object(d.a)({},e),{},{children:Object(i.jsx)("div",{style:{padding:8},className:"mssql-adapter",children:e.data.label||"MSSQL Server"})}))}));n(733),n(734);var Wt=Object(p.b)((function(e){return{types:(e.dashboard.types||[]).map((function(e,t){return{id:e.name.toLowerCase(),type:"typeDef",data:{label:e.name,typedef:e.typeDef},position:{x:200+200*t,y:300},draggable:!1}}))}}),(function(e){return{getTypes:function(){return e(_t())}}}))((function(e){u.a.useEffect((function(){e.getTypes()}),[]);var t=Object(f.useMutation)($t),n=Object(v.a)(t,2),o=n[0],s=(n[1].data,u.a.useState([])),l=Object(v.a)(s,2),d=l[0],j=l[1],b=u.a.useState([]),p=Object(v.a)(b,2),O=p[0],m=p[1];return u.a.useEffect((function(){Lt.query({query:Object(f.gql)(Nt())}).then((function(e){return e.data.integrationMap})).then((function(e){e.nodes&&j(e.nodes.map((function(e){var t=Object(ce.cloneDeep)(e);return delete t.__typename,delete t.position.__typename,t})).slice()),e.links&&m(e.links.map((function(e){var t=Object(ce.cloneDeep)(e);return delete t.__typename,t})).slice())}))}),[]),Object(i.jsx)("div",{className:"admin-view",children:Object(i.jsx)(Te.b,{nodeTypes:[a,r,c],nodes:(e.types||[]).concat(d),links:O,onNodeChange:function(t){var n=t.filter((function(t){return e.types.map((function(e){return e.id})).indexOf(t.id)<0}));o({variables:{nodes:n,links:O}}),j(n)},onLinkChange:function(e){o({variables:{nodes:d,links:e}}),m(e)}})})})),Ht=n(314),Jt=n(656),Qt=n.n(Jt),Kt=(n(1427),Le());var Vt=Object(p.b)((function(e){return{projects:e.projects.list,user:Object(Ht.a)(e.auth.token)}}),(function(e){return{getTypes:function(){return e(_t())},getPermissions:function(){return e((function(e){return Lt.query({query:Object(f.gql)(Mt())}).then((function(e){return e.data.typePermissions})).then((function(t){console.log(t),e({type:re.i,perms:t})}))}))}}}))((function(e){be.a.parse(e.location.search,{ignoreQueryPrefix:!0}),window.location.pathname.replace(/\/dashboard/g,"");var t=u.a.useState(null),n=Object(v.a)(t,2),a=n[0],r=n[1],c=[{icon:Object(i.jsx)(T.a,{}),label:"Dashboard",path:""},{icon:Object(i.jsx)(E.a,{}),label:"Calendar",path:"/calendar"},{icon:Object(i.jsx)(I.a,{}),label:"Projects",path:"/projects"},{icon:Object(i.jsx)(w.a,{}),label:"Team",path:"/team"},{icon:Object(i.jsx)(D.a,{}),label:"Equipment",path:"/equipment"},{icon:Object(i.jsx)(P.a,{}),label:"Files",path:"/files"}];return u.a.useEffect(Object(x.a)(h.a.mark((function t(){var n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.getTypes(),e.getPermissions(),a){t.next=7;break}return t.next=5,Qt.a.create();case 5:n=t.sent,r(n);case 7:return t.abrupt("return",Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(a||n).stop();case 2:case"end":return e.stop()}}),e)}))));case 8:case"end":return t.stop()}}),t)}))),[]),Object(i.jsxs)("div",{className:"dashapp",children:[Object(i.jsxs)(q.a,{variant:"permanent",style:{width:200},children:[Object(i.jsxs)(k.a,{style:{flex:1,width:200},children:[Object(i.jsx)(C.a,{style:{fontWeight:"bold",padding:12,fontSize:20},children:"WorkHub"}),Object(i.jsx)(S.a,{}),c.map((function(t,n){return Object(i.jsxs)(C.a,{className:c.map((function(e){return e.path})).indexOf(window.location.pathname.split(e.match.url)[1])==n?"selected menu-item":"menu-item",onClick:function(){return e.history.push("".concat(e.match.url).concat(t.path))},button:!0,children:[t.icon," ",t.label]})}))]}),Object(i.jsx)(S.a,{}),Object(i.jsxs)(C.a,{button:!0,onClick:function(){return e.history.push("".concat(e.match.url,"/settings"))},children:[Object(i.jsx)(N.a,{style:{marginRight:12}}),"Settings"]})]}),Object(i.jsx)("div",{className:"dashapp-body",children:Object(i.jsxs)(b.d,{children:[Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/calendar"),render:function(e){return Object(i.jsx)(dt,Object(d.a)(Object(d.a)({},e),{},{y:Kt}))}}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/projects"),component:fe,exact:!0}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/projects/:id"),render:function(e){return Object(i.jsx)(Je,Object(d.a)(Object(d.a)({},e),{},{y:Kt}))}}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/files"),render:function(e){return Object(i.jsx)(Qe.a,Object(d.a)(Object(d.a)({},e),{},{ipfs:a}))}}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/team"),component:ht}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/equipment"),component:kt}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/settings"),component:jt}),Object(i.jsx)(b.b,{path:"".concat(e.match.url,"/admin"),component:Wt})]})})]})}));function Yt(){var e=Object(ae.a)(["\n    mutation Login($username: String, $password: String){\n        login(username: $username, password: $password){\n            token\n            error\n        }\n    }\n"]);return Yt=function(){return e},e}var Xt=Object(f.gql)(Yt());n(1428);var Zt,en=Object(p.b)(null,(function(e){return{setToken:function(t){return e(function(e){return function(t){t({type:re.o,token:e})}}(t))}}}))((function(e){var t=u.a.useState(null),n=Object(v.a)(t,2),a=n[0],r=n[1],c=u.a.useState(""),o=Object(v.a)(c,2),s=o[0],l=o[1],d=u.a.useState(""),j=Object(v.a)(d,2),b=j[0],p=j[1],O=Object(f.useMutation)(Xt),m=Object(v.a)(O,1)[0],h=function(){m({variables:{username:s,password:b}}).then((function(t){t.data.login&&t.data.login.token?(e.setToken(t.data.login.token),e.history.push("/dashboard")):t.data.login&&t.data.login.error&&r(t.data.login.error)}))};return Object(i.jsxs)("div",{className:"login-view",children:[Object(i.jsx)("div",{className:"image-banner"}),Object(i.jsxs)(G.a,{style:{display:"flex",flex:.3,flexDirection:"column",padding:8},children:[Object(i.jsx)(M.a,{variant:"h6",children:"WorkHub"}),Object(i.jsx)(S.a,{}),Object(i.jsx)(W.a,{error:a,label:"Username",value:s,onChange:function(e){return l(e.target.value)}}),Object(i.jsx)(W.a,{error:a,label:"Password",type:"password",value:b,onKeyDown:function(e){13==e.keyCode&&h()},onChange:function(e){return p(e.target.value)}}),Object(i.jsx)(Q.a,{onClick:h,style:{marginTop:12},color:"primary",variant:"contained",children:"Login"})]})]})})),tn=n(657),nn=n(658),an=n(87),rn=n(141),cn=n(659),on=n(427),un=n(660),sn=n.n(un),ln={list:[]};var dn={permissions:[],types:[]};var jn={list:[]};var bn={token:null};var fn,pn={list:[]};var On={list:[]};var mn={bookings:[]};var hn=Object(rn.c)({projects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.m:return Object(d.a)(Object(d.a)({},e),{},{list:t.projects});case re.g:var n=(Zt=e.list.slice()).map((function(e){return e.id})).indexOf(t.id);return Zt.splice(n,1),Object(d.a)(Object(d.a)({},e),{},{list:Zt});case re.d:return Object(d.a)(Object(d.a)({},e),{},{list:e.list.concat([t.newProject])});case re.q:var a=(Zt=e.list.slice()).map((function(e){return e.id})).indexOf(t.id);return Zt[a]=Object(d.a)(Object(d.a)({},Zt[a]),t.project),Object(d.a)(Object(d.a)({},e),{},{list:Zt});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.o:return{token:t.token};default:return e}},files:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.l:return Object(d.a)(Object(d.a)({},e),{},{list:t.files});case re.c:return Object(d.a)(Object(d.a)({},e),{},{list:e.list.concat([t.file])});default:return e}},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.h:return Object(d.a)(Object(d.a)({},e),{},{bookings:t.bookings});case re.a:return Object(d.a)(Object(d.a)({},e),{},{bookings:e.bookings.concat([t.booking])});default:return e}},dashboard:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.i:return Object(d.a)(Object(d.a)({},e),{},{permissions:t.perms});case re.j:return Object(d.a)(Object(d.a)({},e),{},{types:t.types});default:return e}},equipment:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.k:return Object(d.a)(Object(d.a)({},e),{},{list:t.equipment});case re.b:return Object(d.a)(Object(d.a)({},e),{},{list:e.list.concat([t.newItem])});case re.p:var n=(fn=e.list.slice()).map((function(e){return e.id})).indexOf(t.id);return fn[n]=Object(d.a)(Object(d.a)({},fn[n]),t.equipment),Object(d.a)(Object(d.a)({},e),{},{list:fn});case re.f:var a=(fn=e.list.slice()).map((function(e){return e.id})).indexOf(t.id);return fn.splice(a,1),Object(d.a)(Object(d.a)({},e),{},{list:fn});default:return e}},team:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:On,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case re.n:return Object(d.a)(Object(d.a)({},e),{},{list:t.team});case re.e:return Object(d.a)(Object(d.a)({},e),{},{list:e.list.concat([t.newMember])});default:return e}}}),xn={key:"root",storage:sn.a},vn=Object(on.a)(xn,hn),gn=(n(1431),function(){var e=Object(rn.d)(vn,Object(rn.a)(cn.a));return{store:e,persistor:Object(on.b)(e)}}()),yn=gn.store,qn=gn.persistor,kn=Object(ie.a)();var Cn=function(){return Object(i.jsx)(an.a,{utils:nn.a,children:Object(i.jsx)(p.a,{store:yn,children:Object(i.jsx)(f.ApolloProvider,{client:kn,children:Object(i.jsx)(j.a,{children:Object(i.jsx)(tn.a,{loading:null,persistor:qn,children:Object(i.jsxs)("div",{className:"App",children:[Object(i.jsx)(b.b,{path:"/",exact:!0,component:en}),Object(i.jsx)(b.b,{path:"/dashboard",render:function(e){return yn.getState().auth.token?Object(i.jsx)(Vt,Object(d.a)({},e)):Object(i.jsx)(b.a,{to:"/"})}})]})})})})})})},Sn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1509)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},Tn=n(236);Tn.c.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(Tn.c.version,"/pdf.worker.js"),l.a.render(Object(i.jsx)(u.a.StrictMode,{children:Object(i.jsx)(Cn,{})}),document.getElementById("root")),Sn()},198:function(e,t,n){"use strict";n.d(t,"c",(function(){return j})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return O}));var a=n(60),r=n(38),c=n(36),i=n(121);function o(){var e=Object(a.a)(["\n        query GetFiles{\n          files{\n            id\n            filename\n            cid\n            extension\n          }\n        }\n      "]);return o=function(){return e},e}function u(){var e=Object(a.a)(["\n    mutation ConvertFile($fileId: ID, $targetFormat:String){\n      convertFile(fileId: $fileId, targetFormat: $targetFormat){\n        msg\n        error\n      }\n    }\n"]);return u=function(){return e},e}function s(){var e=Object(a.a)(["\n    mutation AttachFile($projectId: ID, $fileId: ID){\n      attachFileToProject(projectId: $projectId, fileId: $fileId){\n        files{\n          cid\n        }\n      }\n    }\n"]);return s=function(){return e},e}function l(){var e=Object(a.a)(["\n    mutation UploadFile($file: Upload!){\n      uploadFile(file: $file) {\n        duplicate\n        file{\n          id\n          filename\n          cid\n          extension\n        }\n      }\n    }\n  "]);return l=function(){return e},e}var d=Object(i.a)(),j=Object(c.gql)(l()),b=Object(c.gql)(s()),f=Object(c.gql)(u()),p=function(e){return function(t){t({type:r.c,file:e})}},O=function(){return function(e,t){return d.query({query:Object(c.gql)(o())}).then((function(e){return e.data.files})).then((function(t){e({type:r.l,files:t})}))}}},345:function(e,t){},38:function(e,t,n){"use strict";n.d(t,"m",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"g",(function(){return c})),n.d(t,"q",(function(){return i})),n.d(t,"n",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"k",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return j})),n.d(t,"l",(function(){return b})),n.d(t,"h",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"o",(function(){return O})),n.d(t,"c",(function(){return m})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return x}));var a="SET_PROJECTS",r="ADD_PROJECT",c="REMOVE_PROJECT",i="UPDATE_PROJECT",o="SET_TEAM",u="ADD_TEAM_MEMBER",s="SET_EQUIPMENT",l="ADD_EQUIPMENT",d="UPDATE_EQUIPMENT",j="REMOVE_EQUIPMENT",b="SET_FILES",f="SET_BOOKINGS",p="ADD_BOOKING",O="SET_TOKEN",m="ADD_FILE",h="SET_DASHBOARD_TYPES",x="SET_DASHBOARD_PERMS"},418:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(21),r=n(3),c=n(0),i=n.n(c),o=n(236);function u(e){var t=i.a.useState(null),n=Object(a.a)(t,2),c=n[0],u=n[1],s=i.a.useState(1),l=Object(a.a)(s,2);l[0],l[1];return Object(r.jsx)(o.a,{file:e.file,onLoadSuccess:function(e){var t=e.numPages;u(t)},children:Array.from(new Array(c),(function(e,t){return Object(r.jsx)(o.b,{pageNumber:t+1},"page_".concat(t+1))}))})}},647:function(e,t,n){"use strict";(function(e){var a=n(18),r=n(2),c=n.n(r),i=n(89),o=n(21),u=n(99),s=n(3),l=n(0),d=n.n(l),j=n(1434),b=n(1442),f=n(428),p=n(1435),O=n(667),m=n(1447),h=n(664),x=n(1438),v=n(1441),g=n(133),y=(n(418),n(649)),q=n(36),k=n(198),C=n(662),S=n(77);n(727);t.a=Object(S.b)((function(e){return{files:e.files.list}}),(function(e){return{addFile:function(t){return e(Object(k.d)(t))},getFiles:function(){return e(Object(k.e)())}}}))((function(t){var n=Object(q.useMutation)(k.c),r=Object(o.a)(n,2),S=r[0],T=r[1].data,E=Object(q.useMutation)(k.b),I=(Object(o.a)(E,1)[0],d.a.useState(null)),w=Object(o.a)(I,2),D=w[0],P=w[1],N=Object(l.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n&&n.length>0&&(console.log(n),S({variables:{file:n[0]}}).then((function(e){e.data&&e.data.uploadFile&&!e.data.uploadFile.duplicate&&t.addFile(e.data.uploadFile.file)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[T]),M=Object(C.a)({onDrop:N}),A=M.getRootProps,L=M.getInputProps,$=M.isDragActive,_=d.a.useState([]),F=Object(o.a)(_,2);return F[0],F[1],d.a.useEffect((function(){t.getFiles()}),[]),[Object(s.jsx)(g.a,{tabs:[],onTabSelect:function(e){},selectedTab:"",title:"Files"}),Object(s.jsxs)(f.a,{style:{marginTop:12,flex:1,position:"relative",display:"flex",flexDirection:"column"},children:[Object(s.jsx)(y.a,{open:D,onClose:function(){return P(null)},file:D}),Object(s.jsxs)("div",Object(a.a)(Object(a.a)({},A()),{},{style:{flex:1,display:"flex",flexDirection:"column"},children:[Object(s.jsx)("input",Object(a.a)({},L())),Object(s.jsx)(p.a,{className:$?"file-list selected":"file-list",children:t.files.map((function(n){return[Object(s.jsxs)(O.a,{button:!0,onClick:function(a){a.stopPropagation();var r={fileId:n.id,targetFormat:"glb"};(console.log(r),t.ipfs)&&function(){var n=Object(i.a)(c.a.mark((function n(a){var r,i,o,s,l,d,j,b,f;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.ipfs){n.next=38;break}console.log(a),r=t.ipfs.cat(a.cid),i=e.from(""),o=!0,s=!1,n.prev=6,d=Object(u.a)(r);case 8:return n.next=10,d.next();case 10:return j=n.sent,o=j.done,n.next=14,j.value;case 14:if(b=n.sent,o){n.next=21;break}f=b,i=e.concat([i,f]);case 18:o=!0,n.next=8;break;case 21:n.next=27;break;case 23:n.prev=23,n.t0=n.catch(6),s=!0,l=n.t0;case 27:if(n.prev=27,n.prev=28,o||null==d.return){n.next=32;break}return n.next=32,d.return();case 32:if(n.prev=32,!s){n.next=35;break}throw l;case 35:return n.finish(32);case 36:return n.finish(27);case 37:P({filename:a.filename,extension:a.extension,content:i});case 38:case"end":return n.stop()}}),n,null,[[6,23,27,37],[28,,32,36]])})));return function(e){return n.apply(this,arguments)}}()(n)},children:[Object(s.jsx)(m.a,{onClick:function(e){e.stopPropagation()}}),Object(s.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[Object(s.jsx)("div",{children:n.filename}),Object(s.jsx)("span",{style:{fontSize:10},children:n.cid})]}),Object(s.jsx)(h.a,{onClick:function(e){e.stopPropagation()},children:Object(s.jsx)(j.a,{})})]}),Object(s.jsx)(x.a,{})]}))})]})),Object(s.jsx)(v.a,{style:{position:"absolute",right:8,bottom:8},color:"primary",children:Object(s.jsx)(b.a,{})})]})]}))}).call(this,n(30).Buffer)},649:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(3),r=(n(0),n(668)),c=n(1440),i=n(670),o=n(671),u=n(237),s=n(418);function l(e){var t=e.file||{};return Object(a.jsxs)(r.a,{fullWidth:!0,open:e.open,onClose:e.onClose,children:[Object(a.jsx)(c.a,{children:t.name}),Object(a.jsx)(i.a,{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:function(){switch(t.extension){case"pdf":return Object(a.jsx)(s.a,{file:{data:t.content}});default:return null}}()}),Object(a.jsx)(o.a,{children:Object(a.jsx)(u.a,{onClick:e.onClose,children:"Close"})})]})}},686:function(e,t,n){},691:function(e,t,n){},692:function(e,t,n){},703:function(e,t,n){},711:function(e,t,n){},715:function(e,t,n){},722:function(e,t){},723:function(e,t){},724:function(e,t){},725:function(e,t){},726:function(e,t){},727:function(e,t,n){},729:function(e,t,n){},730:function(e,t,n){},732:function(e,t,n){},734:function(e,t,n){},738:function(e,t){},744:function(e,t){},818:function(e,t){},819:function(e,t){},915:function(e,t){},917:function(e,t){},976:function(e,t){}},[[1432,1,2]]]);
//# sourceMappingURL=main.118978ef.chunk.js.map